library(tidyverse)

# creating scenarios table
scenarios <- tibble(
  scenario = c(1, 2, 3, 4),
  transition = c("bad weather", "bad weather", "normal weather", "normal weather"),
  background = c("normal", "poor","normal", "poor")
) %>%
  mutate(transition = factor(transition, levels = c("normal weather", "bad weather")),
         background = factor(background, levels = c("normal", "poor")))



# generation simulated data
exploitation_sce1 <- sample(c(rep(1, 5), rep(2, 10), rep(3, 15), rep(4, 30), rep(5, 20))) %>%
  as_tibble() %>%
  mutate(scenario = 1, subject = 1:80)
exploitation_sce2 <- sample(c(rep(1, 1), rep(2, 4), rep(3, 10), rep(4, 30), rep(5, 35))) %>%
  as_tibble() %>%
  mutate(scenario = 2, subject = 1:80)
exploitation_sce3 <- sample(c(rep(1, 10), rep(2, 30), rep(3, 30), rep(4, 5), rep(5, 5))) %>%
  as_tibble() %>%
  mutate(scenario = 3, subject = 1:80)
exploitation_sce4 <- sample(c(rep(1, 5), rep(2, 20), rep(3, 25), rep(4, 20), rep(5, 10))) %>%
  as_tibble() %>%
  mutate(scenario = 4, subject = 1:80)

simulated_data <- bind_rows(
  exploitation_sce1,
  exploitation_sce2,
  exploitation_sce3,
  exploitation_sce4
) %>%
  select(subject, scenario, value) %>%
  rename(exploitation=value) %>% 
  arrange(subject, scenario) %>% 
  left_join(scenarios) %>% 
  relocate(exploitation,.after = background) %>% 
  mutate(exploitation=
           as_factor(exploitation) %>% 
             fct_recode(
               "absolutely exploitation" = "5", 
               "somehow exploitation" = "4",
               "no idea" = "3",
               "probably not exploitation" = "2",
               "absolutely not exploitation" = "1"
             )
        )

simulated_data %>% openxlsx::write.xlsx("simulated_data.xlsx")
